# YOLOv5n VisDrone Experiment 2 - Phase 2C Hyperparameters (Epochs 71-100)
# Fine-tuning Phase
# Final optimization with lowest learning rate

# Learning Rate Configuration (Fine-tuning)
lr0: 0.0001  # Very low learning rate for fine-tuning
lrf: 0.1     # Final OneCycleLR learning rate factor
momentum: 0.937  # SGD momentum/Adam beta1
weight_decay: 0.0005  # Optimizer weight decay 5e-4
warmup_epochs: 0.0  # No warmup needed (resuming from checkpoint)
warmup_momentum: 0.8  # Warmup initial momentum
warmup_bias_lr: 0.1  # Warmup initial bias lr

# Cosine LR scheduler
cos_lr: True  # Continue cosine LR scheduler

# Loss Component Weights (Balanced)
box: 0.05  # Box loss gain
cls: 0.5   # Classification loss gain (balanced)
cls_pw: 1.0  # Class loss positive weight
obj: 0.5   # Object loss gain (balanced)
obj_pw: 1.0  # Object loss positive weight

# Anchor Configuration
anchor_t: 4.0  # Anchor-multiple threshold
anchors: 3  # Anchors per output layer (0 to ignore)

# Augmentation Settings (DISABLED for Phase 1)
fl_gamma: 0.0  # Focal loss gamma
hsv_h: 0.0  # Image HSV-Hue augmentation (fraction)
hsv_s: 0.0  # Image HSV-Saturation augmentation (fraction)
hsv_v: 0.0  # Image HSV-Value augmentation (fraction)
degrees: 0.0  # Image rotation (+/- deg)
translate: 0.0  # Image translation (+/- fraction)
scale: 0.0  # Image scale (+/- gain)
shear: 0.0  # Image shear (+/- deg)
perspective: 0.0  # Image perspective (+/- fraction)
flipud: 0.0  # Image flip up-down (probability)
fliplr: 0.0  # Image flip left-right (probability)
mosaic: 0.0  # Image mosaic (probability) - DISABLED
mixup: 0.0  # Image mixup (probability)
copy_paste: 0.0  # Segment copy-paste (probability)

# Training Configuration
label_smoothing: 0.1  # Increased label smoothing for final regularization
nbs: 64  # Nominal batch size for normalization